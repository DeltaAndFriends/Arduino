// sudo chmod a+rw /dev/ttyUSB0
#include "Init.h"
#include "Scenarios.h"

void setup() {
  Serial.begin(2000000);
  if (DEBUG) Serial.begin(9600);
  if (DEBUG) Serial.println("Hi");
  //if(DEBUG) std::cout << "START " << std::endl;
  robot.setup();
  if (DEBUG) Serial.println("setup ok");
}

void check_mode()
{
  // TODO: instead of static must be mode switcher, e.g. signal from a button
  static int mode = 1;
  static int cur_mode = 0;
  if (cur_mode == mode)
  {
    return;
  }
  cur_mode = mode;

  using namespace Delta;
 
  switch (cur_mode)
  {
    case 1:
      robot.set_scenario(Scenario1);
      break;
    case 2:
      robot.set_scenario(Scenario2);
      break;
  }
}

int arr[72][6] = {
    {21, -39, 13, 0, 0, 0},
    {17, -37, 15, 0, 0, 0},
    {13, -35, 18, 0, 0, 0},
    {9, -32, 20, 0, 0, 0},
    {5, -30, 22, 0, 0, 0},
    {1, -27, 25, 0, 0, 0},
    {-3, -24, 28, 0, 0, 0},
    {-7, -22, 30, 0, 0, 0},
    {-11, -19, 33, 0, 0, 0},
    {-14, -17, 35, 0, 0, 0},
    {-18, -14, 38, 0, 0, 0},
    {-22, -12, 40, 0, 0, 0},
    {-26, -10, 41, 0, 0, 0},
    {-29, -8, 42, 0, 0, 0},
    {-33, -6, 43, 0, 0, 0},
    {-36, -4, 43, 0, 0, 0},
    {-38, -2, 43, 0, 0, 0},
    {-41, 0, 42, 0, 0, 0},
    {-42, 1, 40, 0, 0, 0},
    {-43, 3, 38, 0, 0, 0},
    {-44, 5, 35, 0, 0, 0},
    {-43, 7, 32, 0, 0, 0},
    {-42, 9, 28, 0, 0, 0},
    {-41, 11, 25, 0, 0, 0},
    {-39, 13, 21, 0, 0, 0},
    {-37, 15, 17, 0, 0, 0},
    {-35, 18, 13, 0, 0, 0},
    {-32, 20, 9, 0, 0, 0},
    {-30, 22, 5, 0, 0, 0},
    {-27, 25, 1, 0, 0, 0},
    {-24, 28, -3, 0, 0, 0},
    {-22, 30, -7, 0, 0, 0},
    {-19, 33, -11, 0, 0, 0},
    {-17, 35, -14, 0, 0, 0},
    {-14, 38, -18, 0, 0, 0},
    {-12, 40, -22, 0, 0, 0},
    {-10, 41, -26, 0, 0, 0},
    {-8, 42, -29, 0, 0, 0},
    {-6, 43, -33, 0, 0, 0},
    {-4, 43, -36, 0, 0, 0},
    {-2, 43, -38, 0, 0, 0},
    {0, 42, -41, 0, 0, 0},
    {1, 40, -42, 0, 0, 0},
    {3, 38, -43, 0, 0, 0},
    {5, 35, -44, 0, 0, 0},
    {7, 32, -43, 0, 0, 0},
    {9, 28, -42, 0, 0, 0},
    {11, 25, -41, 0, 0, 0},
    {13, 21, -39, 0, 0, 0},
    {15, 17, -37, 0, 0, 0},
    {18, 13, -35, 0, 0, 0},
    {20, 9, -32, 0, 0, 0},
    {22, 5, -30, 0, 0, 0},
    {25, 1, -27, 0, 0, 0},
    {28, -3, -24, 0, 0, 0},
    {30, -7, -22, 0, 0, 0},
    {33, -11, -19, 0, 0, 0},
    {35, -14, -17, 0, 0, 0},
    {38, -18, -14, 0, 0, 0},
    {40, -22, -12, 0, 0, 0},
    {41, -26, -10, 0, 0, 0},
    {42, -29, -8, 0, 0, 0},
    {43, -33, -6, 0, 0, 0},
    {43, -36, -4, 0, 0, 0},
    {43, -38, -2, 0, 0, 0},
    {42, -41, 0, 0, 0, 0},
    {40, -42, 1, 0, 0, 0},
    {38, -43, 3, 0, 0, 0},
    {35, -44, 5, 0, 0, 0},
    {32, -43, 7, 0, 0, 0},
    {28, -42, 9, 0, 0, 0},
    {28, -42, 9, 0, 0, 0}};
void loop() {
  delay(10);

  while(1){

    robot.achieve(0,0,0,0,0,0);
    robot.achieve(0,0,0,0,0,0);

    int k = 1;
    robot.moveMotors(-178/k, 289/k, 590/k, 0, 0, 0);
    for(int j = 0; j < 10; j++){
      for(int i = 0; i < 72; i++){
       robot.moveMotors(
       -arr[i][0]/k,
       -arr[i][1]/k,
       -arr[i][2]/k,
       -arr[i][3]/k,
       -arr[i][4]/k,
       -arr[i][5]/k);
      } 
    }
  }
  while(1);
}
